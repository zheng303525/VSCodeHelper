# VS Code GitHub Copilot Chat 自动监控工具

这是一个智能的自动化工具，用于监控VS Code中的GitHub Copilot Chat状态。当检测到Copilot Chat停止响应时，会自动发送"continue"命令来恢复对话，确保连续的代码生成体验。

## ✨ 核心特性

### 🚀 多版本支持
- **标准版本**：基于OCR和屏幕截图的传统监控
- **高级版本**：支持锁屏状态下的持续监控（推荐）
- **GUI版本**：用户友好的图形界面

### 🔐 防息屏功能
- **自动防止屏幕息屏**：监控期间自动阻止系统休眠
- **锁屏状态支持**：高级版本在锁屏时也能正常工作
- **多种监控策略**：进程监控、日志监控、文件系统监控

### 🤖 智能检测
- **自动窗口检测**：智能找到VS Code窗口
- **状态识别**：使用OCR技术识别Copilot Chat状态
- **多语言支持**：支持中英文界面识别
- **自定义关键词**：可配置状态检测关键词

### ⚙️ 高度可配置
- **监控间隔**：自定义检查频率
- **命令内容**：自定义继续命令文本
- **日志级别**：控制日志详细程度
- **安全设置**：防止意外操作

## 🚀 快速开始

### 1. 最简单的启动方式
```bash
python start.py
```

这会打开一个交互式菜单，让您选择：
1. **标准命令行版本** - 适合正常使用场景
2. **高级监控版本** - 支持锁屏状态（推荐）
3. **GUI图形界面版本** - 用户友好界面
4. **功能测试** - 验证安装和配置
5. **依赖检查** - 自动安装所需组件

### 2. Windows一键启动
```bash
# 双击运行，自动设置环境
start_monitor.bat
```

### 3. 直接启动特定版本
```bash
# 标准版本
python copilot_monitor.py

# 高级版本（支持锁屏）
python copilot_monitor_advanced.py

# GUI版本
python copilot_monitor_gui.py
```

## 📋 系统要求

- **操作系统**：Windows 10/11
- **Python**：3.8 或更高版本
- **VS Code**：已安装GitHub Copilot扩展
- **Tesseract OCR**：用于文字识别（标准版本需要）

## 🔧 安装依赖

### 自动安装（推荐）
```bash
python start.py
# 选择选项5进行依赖检查和安装
```

### 手动安装
```bash
# 安装Python包
pip install -r requirements.txt

# 安装Tesseract OCR
# 1. 下载：https://github.com/UB-Mannheim/tesseract/wiki
# 2. 安装到：C:\Program Files\Tesseract-OCR\
# 3. 添加到系统PATH环境变量
```

## ⚙️ 配置选项

编辑 `config.ini` 文件来自定义设置：

### 基本监控设置
```ini
[MONITOR]
# 检查间隔（秒）
check_interval = 30
# 是否防止屏幕息屏（推荐开启）
prevent_sleep = true
```

### 自动化设置
```ini
[AUTOMATION]
# 发送的继续命令
continue_command = continue
# 备用命令（中文）
continue_command_alt = 继续
```

### 高级监控设置
```ini
[ADVANCED]
# 是否启用进程监控
use_process_monitoring = true
# 是否启用日志监控
use_log_monitoring = true
# 无活动阈值（秒）
inactivity_threshold = 300
```

## 💡 版本对比

| 功能特性 | 标准版本 | 高级版本 | GUI版本 |
|---------|---------|---------|---------|
| OCR文字识别 | ✅ | ✅ | ✅ |
| 自动发送命令 | ✅ | ✅ | ✅ |
| 防止息屏 | ✅ | ✅ | ✅ |
| 锁屏状态支持 | ❌ | ✅ | ❌ |
| 进程监控 | ❌ | ✅ | ❌ |
| 日志监控 | ❌ | ✅ | ❌ |
| 图形界面 | ❌ | ❌ | ✅ |
| 资源消耗 | 低 | 中 | 中 |

### 💡 推荐使用高级版本以获得最佳体验！

## 🛡️ 防息屏和锁屏功能

### 自动防止息屏
工具会自动：
- 阻止系统休眠和屏幕保护
- 禁用自动锁屏功能
- 定期模拟用户活动
- 在监控结束时恢复原始设置

### 锁屏状态下工作（高级版本）
即使在系统锁定状态下，高级版本仍能：
- 监控VS Code进程状态
- 分析VS Code日志文件
- 检测Copilot活动状态
- 通过多种方式发送命令

### 工作原理
1. **Windows API调用**：使用系统API防止休眠
2. **注册表操作**：临时禁用屏幕保护程序
3. **进程监控**：实时检查VS Code运行状态
4. **日志分析**：监控VS Code和Copilot日志
5. **多重发送策略**：确保命令能够成功发送

## 🧪 功能测试

运行测试来验证所有功能：
```bash
python test_detection.py
```

测试内容包括：
- ✅ Python依赖包检查
- ✅ Tesseract OCR配置验证
- ✅ VS Code窗口检测
- ✅ 屏幕截图功能
- ✅ OCR文字识别
- ✅ 自动化操作测试
- ✅ 防息屏功能测试

## 💻 工作原理

### 标准版本流程
1. **窗口检测** → **屏幕截图** → **OCR识别** → **状态分析** → **自动干预**

### 高级版本流程
1. **进程监控** → **日志分析** → **文件系统检查** → **综合判断** → **多策略发送**

### 状态判断逻辑
- **停止状态**：检测到关键词如"stopped"、"completed"、"完成"等
- **运行状态**：检测到关键词如"thinking"、"processing"、"运行中"等
- **错误状态**：检测到超时、失败等异常情况

## 📊 日志和监控

### 日志文件
- `copilot_monitor.log` - 标准版本日志
- `copilot_monitor_advanced.log` - 高级版本日志

### 日志级别
- **DEBUG**：详细的调试信息
- **INFO**：一般运行信息
- **WARNING**：警告信息
- **ERROR**：错误信息

### 实时监控
GUI版本提供：
- 实时状态显示
- 日志输出窗口
- 配置参数调整
- 一键启停控制

## 🔒 安全考虑

### 自动化安全
- **故障安全**：PyAutoGUI的故障安全机制
- **操作间隔**：防止过于频繁的自动操作
- **权限控制**：只操作VS Code相关窗口

### 隐私保护
- **本地运行**：所有操作在本地完成
- **无网络传输**：不上传任何截图或文本
- **日志加密**：敏感信息不记录到日志

## 🛠️ 故障排除

### 常见问题

**Q: 程序启动失败**
- 检查Python版本（需要3.8+）
- 安装所有依赖包：`pip install -r requirements.txt`
- 确保Tesseract OCR正确安装

**Q: 无法检测到VS Code窗口**
- 确保VS Code正在运行
- 检查窗口标题是否匹配
- 尝试重新启动VS Code

**Q: OCR识别不准确**
- 调整OCR置信度阈值
- 检查屏幕缩放设置
- 确保VS Code界面清晰可见

**Q: 在锁屏状态下不工作**
- 使用高级监控版本
- 确保防息屏功能已启用
- 检查系统权限设置

**Q: 自动化操作失败**
- 检查PyAutoGUI权限
- 确认VS Code窗口为活动窗口
- 调整操作延迟时间

### 获取帮助
1. 查看日志文件了解详细错误信息
2. 运行功能测试诊断问题
3. 检查配置文件设置是否正确

## 📝 更新日志

### v2.0.0 - 防息屏和锁屏支持
- ✨ 新增高级监控版本
- 🔐 支持锁屏状态下工作
- 🛡️ 自动防止屏幕息屏功能
- 📊 多种监控策略
- ⚙️ 更丰富的配置选项

### v1.0.0 - 初始版本
- 🤖 基本的OCR识别和自动化
- 📱 GUI图形界面
- ⚙️ 可配置参数
- 📝 详细日志记录

## 📄 许可证

MIT License - 详见 LICENSE 文件

## 🤝 贡献

欢迎提交问题报告和功能建议！

---

**享受更流畅的Copilot Chat体验！** 🚀 