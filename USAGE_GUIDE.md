# 使用指南 - 防息屏和锁屏功能

## 🎯 选择合适的版本

### 📱 如果您需要在锁屏时也能工作
**推荐使用：高级监控版本**
```bash
python start.py
# 选择选项 2
```

### 🖥️ 如果您只在正常使用时监控
**可以使用：标准版本或GUI版本**
```bash
python start.py
# 选择选项 1 或 3
```

## 🔐 防息屏功能说明

### 自动启用的功能
当您启动监控时，工具会自动：

1. **阻止系统休眠**
   - 使用Windows API防止电脑进入睡眠状态
   - 保持CPU和显示器活跃

2. **禁用屏幕保护程序**
   - 临时关闭屏幕保护程序
   - 防止屏幕被锁定

3. **模拟用户活动**
   - 每5分钟轻微移动鼠标
   - 防止系统认为用户离开

### 自动恢复设置
当您停止监控时，工具会：
- 恢复原始的电源管理设置
- 重新启用屏幕保护程序
- 停止模拟用户活动

## 🚀 高级版本的锁屏支持

### 工作原理
即使在系统锁定状态下，高级版本仍能：

1. **监控VS Code进程**
   - 检查VS Code是否仍在运行
   - 监控进程的CPU和内存使用情况

2. **分析日志文件**
   - 读取VS Code的日志文件
   - 检测Copilot扩展的活动状态

3. **发送命令**
   - 通过剪贴板发送文本
   - 使用Windows消息机制
   - 创建命令文件与VS Code通信

### 使用场景
- 🌙 **夜间长时间生成代码**
- 💼 **工作时需要临时锁屏**
- 🔒 **公司安全策略要求定期锁屏**

## ⚙️ 配置防息屏功能

在 `config.ini` 文件中：

```ini
[MONITOR]
# 是否防止屏幕息屏（推荐开启）
prevent_sleep = true

[ADVANCED]
# 是否在锁屏状态下尝试自动化操作
automation_in_locked_screen = true
```

## 🛡️ 安全注意事项

### 防息屏功能
- ✅ **安全**：只在监控期间暂时禁用
- ✅ **可逆**：停止监控时自动恢复
- ✅ **本地**：不涉及网络传输

### 锁屏状态操作
- ✅ **权限受限**：只能执行基本的文本操作
- ✅ **无法截图**：锁屏时无法访问屏幕内容
- ✅ **进程监控**：通过系统API安全地检查进程状态

## 🔍 故障排除

### 防息屏不生效
1. **检查权限**：确保程序有足够的系统权限
2. **查看日志**：检查是否有错误信息
3. **手动测试**：暂时禁用防息屏功能测试

### 锁屏状态下不工作
1. **使用高级版本**：确保选择了选项2
2. **检查配置**：确认 `automation_in_locked_screen = true`
3. **查看进程**：确认VS Code进程仍在运行

### 恢复系统设置
如果程序异常退出，手动恢复设置：

```bash
# 重新启动程序并正常退出
python start.py

# 或者手动恢复电源设置
# 控制面板 → 电源选项 → 更改计划设置
```

## 💡 最佳实践

### 长期监控建议
1. **使用高级版本**：更稳定可靠
2. **定期检查日志**：确保功能正常
3. **合理设置间隔**：避免过于频繁的检查

### 系统资源优化
1. **关闭不必要的程序**：减少系统负载
2. **调整检查间隔**：较长的间隔消耗更少资源
3. **使用SSD硬盘**：提高文件读取速度

## 📞 获取帮助

遇到问题时：
1. **查看日志文件**：`copilot_monitor.log` 或 `copilot_monitor_advanced.log`
2. **运行测试**：`python test_detection.py`
3. **检查配置**：确认 `config.ini` 设置正确

---

**享受无间断的Copilot Chat体验！** 🎉 